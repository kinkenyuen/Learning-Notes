# 目录

# 概述

运输层为运行在不同主机上的应用程序提供直接的通信服务起着至关重要的作用

计算机网络的一个基础性问题之一是两个实体怎样才能在一种会丢失或损坏数据的媒体上可靠地通信，运输层的TCP可靠传输协议正是被设计用来解决此问题

除此之外，控制运输层实体的传输速率以避免网络中的拥塞，或从拥塞中恢复过来，是第二个基础性问题，TCP的拥塞控制方法有效解决此类问题

**运输层协议为运行在不同主机上的应用进程之间提供了逻辑通信功能**，从应用程序的角度看，通过逻辑通信，运行不同进程的主机好像直接相连了一样；实际上，这些主机可能位于地球的两侧，通过很多路由器以及不同的通信链路相连。应用进程使用运输层提供的逻辑通信功能彼此发送报文，而无须考虑承载这些报文的物理基础措施的细节

运输层协议是在端系统中实现的，而并不是在路由器中实现。在发送端，运输层将从发送应用进程接收到的报文转换成运输层分组，运输层分组称为**报文段(segment)**。实现的方法是将应用报文划分为较小的块，并为每块加上一个运输层首部以生成运输层报文段。然后再发送端系统中，运输层将这些报文段传递给网络层，网络层将其封装成网络层分组（称为数据报）并向目的地发送。

> 网络层只会关心数据报的网络层字段，它不会检查封装在数据报内的运输层报文段的字段

在接收端，网络层从数据报中提取运输层报文段，并将该报文段向上交给运输层。运输层处理收到的报文段，将报文段中的数据交付给接收应用进程使用

运输层提供两种主要协议：

* **TCP(传输控制协议)**，它为调用它的应用程序提供了一种可靠的、面向连接的服务
* **UDP(用户数据报协议)**，它为调用它的应用程序提供了一种不可靠、无连接的服务

**此处将TCP和UDP的分组统称为报文段**

> 在学习运输层之前，简要了解下网络层，网络层使用IP协议，即网际协议。IP为主机之间提供了逻辑通信，IP的服务模型是尽力而为交付服务。意味着它并不做任何确保，它不确保报文的交付，不保证报文段的按序交付，不保证报文段中数据完整性。**IP被称为不可靠服务**

TCP和UDP最基本的责任是，将两个端系统间IP的交付服务扩展为运行在端系统上的两个进程之间的交付服务。将主机间的交付服务扩展到进程间交付被称为运输层的**多路复用(transport-layer multiplexing)**与**多路分解(demultiplexing)**

TCP和UDP还可以通过在其报文段首部中包括差错检查字段而提供完整性检查。进程到进程的数据交付和差错检查是两种最低限度的运输层服务，也是UDP所能提供的仅有的两种服务

TCP提供了集中附加服务，首先，它提供**可靠数据传输(reliable data transfer)**，通过流量控制、序号、确认和定时器确保正确地、按序地将数据从发送进程交付给接收进程。这样，TCP就将两个端系统间的不可靠IP服务转换成了一种进程间的可靠数据服务

TCP还提供了拥塞控制(congestion control)，拥塞控制与其说是一种提供给调用它的应用程序的服务，不如说是一种提供给整个因特网的服务。**因为它防止任何一条TCP连接用过多流量来淹没通信主机之间的链路和交换设备**，可以通过调节TCP连接的发送端发送进网络的流量速率来做到（UDP流量是不受管制的，使用UDP传输的应用可以根据其需要以其愿意的任何速率发送数据）

